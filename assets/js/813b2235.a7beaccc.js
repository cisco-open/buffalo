"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[877],{5966:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var r=s(4848),n=s(8453);const i={sidebar_position:4},o="Architecture",c={id:"Getting-started/Architecture",title:"Architecture",description:"Let's take a quick look at how our BUFFALO gateway works under the hood.",source:"@site/docs/Getting-started/Architecture.md",sourceDirName:"Getting-started",slug:"/Getting-started/Architecture",permalink:"/docs/Getting-started/Architecture",draft:!1,unlisted:!1,editUrl:"https://github.com/cisco-open/buffalo/tree/main/docs/Getting-started/Architecture.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Usage (Demos)",permalink:"/docs/Getting-started/Usage"},next:{title:"Contributing & Future Directions",permalink:"/docs/Getting-started/Contributing"}},l={},d=[];function a(e){const t={code:"code",h1:"h1",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"architecture",children:"Architecture"}),"\n",(0,r.jsx)(t.p,{children:"Let's take a quick look at how our BUFFALO gateway works under the hood."}),"\n",(0,r.jsxs)(t.p,{children:["The backend (gateway) is a REST API server which we started by running ",(0,r.jsx)(t.code,{children:"python app.py"})]}),"\n",(0,r.jsx)(t.p,{children:"This server contains ALL the actual gateway components/computations, allowing the streamlit frontend to be as light as possible."}),"\n",(0,r.jsx)(t.p,{children:"All streamlit does is call the REST API server w/ corresponding GET/POST request, and displays the output."}),"\n",(0,r.jsxs)(t.p,{children:["All REST API endpoints can be seen in ",(0,r.jsx)(t.code,{children:"app.py"}),", and they are summarized here:"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{style:{textAlign:"center"}}),(0,r.jsx)(t.th,{})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"center"},children:(0,r.jsx)(t.strong,{children:"General"})}),(0,r.jsx)(t.td,{children:(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{children:"(GET) / = default, ensures server is up"}),(0,r.jsx)("li",{children:"(GET) /reset = resets server state"}),(0,r.jsx)("li",{children:"(GET) /docs = gets all documents and file sizes in Enterprise Knowledge Base (set to the .\\gateway\\docs folder)"}),(0,r.jsx)("li",{children:"(GET) /model_list = gets list of all models as specified in admin.yml"}),(0,r.jsx)("li",{children:"(POST) /model = receives query, returns answer given specific LLM"})]})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"center"},children:(0,r.jsx)(t.strong,{children:"Input Layer"})}),(0,r.jsx)(t.td,{children:(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{children:"(POST) /prompt/post = recieves input prompt and selected models, returns cost options"}),(0,r.jsx)("li",{children:"(POST) /cache/search/post = receives prompt, returns cache results"}),(0,r.jsx)("li",{children:"(POST) /cache/model/post = receives query, returns document-specific LLM response (if applicable)"}),(0,r.jsx)("li",{children:"(POST) /cache/add/post = receives prompt/query, adds to cache"})]})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"center"},children:(0,r.jsx)(t.strong,{children:"Output Layer"})}),(0,r.jsx)(t.td,{children:(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{children:"(POST) /exfiltrator/post = receives output of llm, returns leaks, if any"}),(0,r.jsx)("li",{children:"(POST) /exfiltrator/topic/post = receives output of llm, returns list of relevant topics/facts"}),(0,r.jsx)("li",{children:"(POST) /verify/facts/post = receives LLM output, returns list of facts"}),(0,r.jsx)("li",{children:"(POST) /verify/ie/post = receives list of facts, retruns relation triplets for each, if any"}),(0,r.jsx)("li",{children:"(POST) /verify/triplet/post = receives list of triplets, returns matches/info if found"})]})})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"New endpoints can be added in a similar format to app.py"}),"\n",(0,r.jsxs)(t.p,{children:["These endpoints simply call the corresponding functions from each of the classes. The four files house all of the classes/methods for each of the four components (",(0,r.jsx)(t.code,{children:"prompt.py"})," : QueryProcessor, ",(0,r.jsx)(t.code,{children:"cache.py"})," : QACache, ",(0,r.jsx)(t.code,{children:"leaks.py"})," : ExfiltrationModel, ",(0,r.jsx)(t.code,{children:"verify.py"})," : VerificationModel)."]}),"\n",(0,r.jsx)(t.p,{children:"And in Streamlit, our frontend is split into three parts: Col1, Col2A, Col2B"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Col1 is on the left hand side, where the user enters prompt and can see what documents are in the Knowledge base"}),"\n",(0,r.jsx)(t.li,{children:"Col2A is on the right hand side, and displayed first which shows the Prompt and Cache"}),"\n",(0,r.jsx)(t.li,{children:'Col2B is shown after "Submit to LLM" is selected in Col2A, and it shows the Exfiltration and Verification components'}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"\xa0 \xa0"})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>c});var r=s(6540);const n={},i=r.createContext(n);function o(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);